angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("uiDatetimePickerConfig",{dateFormat:"yyyy-MM-dd HH:mm",enableDate:true,enableTime:true,todayText:"Today",nowText:"Now",clearText:"Clear",closeText:"Done",dateText:"Date",timeText:"Time",closeOnDateSelection:true,appendToBody:false,showButtonBar:true}).directive("datetimePicker",["$compile","$parse","$document","$timeout","$position","dateFilter","dateParser","uiDatetimePickerConfig",function(d,e,h,c,g,f,a,b){return{restrict:"A",require:"ngModel",scope:{isOpen:"=?",enableDate:"=?",enableTime:"=?",todayText:"@",nowText:"@",dateText:"@",timeText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(y,s,w,r){var l=b.dateFormat,n,t=angular.isDefined(w.closeOnDateSelection)?y.$parent.$eval(w.closeOnDateSelection):b.closeOnDateSelection,v=angular.isDefined(w.datepickerAppendToBody)?y.$parent.$eval(w.datepickerAppendToBody):b.appendToBody;y.showButtonBar=angular.isDefined(w.showButtonBar)?y.$parent.$eval(w.showButtonBar):b.showButtonBar;y.enableDate=angular.isDefined(y.enableDate)?y.enableDate:b.enableDate;y.enableTime=angular.isDefined(y.enableTime)?y.enableTime:b.enableTime;y.showPicker=y.enableDate?"date":"time";y.todayText=y.todayText||"Today";y.nowText=y.nowText||"Now";y.clearText=y.clearText||"Clear";y.closeText=y.closeText||"Close";y.dateText=y.dateText||"Date";y.timeText=y.timeText||"Time";y.getText=function(z){return y[z+"Text"]||b[z+"Text"]};w.$observe("datetimePicker",function(z){l=z||b.dateFormat;r.$render()});var m=angular.element('<div date-picker-wrap ng-show="showPicker == \'date\'"><div datepicker></div></div><div time-picker-wrap ng-show="showPicker == \'time\'"><div timepicker style="margin:0 auto"></div></div>');m.attr({"ng-model":"date","ng-change":"dateSelection()"});function p(z){return z.replace(/([A-Z])/g,function(A){return"-"+A.toLowerCase()})}var j=angular.element(m.children()[0]);if(w.datepickerOptions){angular.forEach(y.$parent.$eval(w.datepickerOptions),function(A,z){j.attr(p(z),A)})}var o=angular.element(m.children()[1]);if(w.timepickerOptions){angular.forEach(y.$parent.$eval(w.timepickerOptions),function(A,z){o.attr(p(z),A)})}if(!w.datepickerMode){w.datepickerMode="day"}y.watchData={};angular.forEach(["minDate","maxDate","datepickerMode"],function(A){if(w[A]){var z=e(w[A]);y.$parent.$watch(z,function(C){y.watchData[A]=C});j.attr(p(A),"watchData."+A);if(A==="datepickerMode"){var B=z.assign;y.$watch("watchData."+A,function(C,D){if(C!==D){B(y.$parent,C)}})}}});if(w.dateDisabled){j.attr("date-disabled","dateDisabled({ date: date, mode: mode })")}function x(z){return w.dateDisabled&&angular.isDefined(z)&&y.dateDisabled({date:z,mode:y.watchData.datepickerMode})}function k(A){if(!A){r.$setValidity("date",true);return null}else{if(angular.isDate(A)&&!isNaN(A)){r.$setValidity("date",true);return A}else{if(angular.isString(A)){var z=a.parse(A,l)||new Date(A);if(isNaN(z)){r.$setValidity("date",false);return undefined}else{r.$setValidity("date",true);return z}}else{r.$setValidity("date",false);return undefined}}}}r.$parsers.unshift(k);y.dateSelection=function(z){if(y.enableDate&&y.enableTime&&y.showPicker==="time"){if(n&&n!==null&&(y.date!==null||z||z!=null)){if(z&&z!=null){n.setHours(z.getHours());n.setMinutes(z.getMinutes());n.setSeconds(z.getSeconds());n.setMilliseconds(z.getMilliseconds());z=new Date(n)}else{n.setHours(y.date.getHours());n.setMinutes(y.date.getMinutes());n.setSeconds(y.date.getSeconds());n.setMilliseconds(y.date.getMilliseconds())}}}if(angular.isDefined(z)){y.date=z}n=y.date;r.$setViewValue(y.date);r.$render();if(t){if(y.showPicker!="time"){if(y.enableTime){y.showPicker="time"}else{y.isOpen=false;s[0].focus()}}}};s.bind("input change keyup",function(){y.$apply(function(){y.date=r.$modelValue})});r.$render=function(){var z=r.$viewValue?k(r.$viewValue):null;var A=z?f(z,l):"";s.val(A);y.date=z};var u=function(z){if(y.isOpen&&z.target!==s[0]){y.$apply(function(){y.isOpen=false})}};var q=function(A,z){y.keydown(A)};s.bind("keydown",q);y.keydown=function(z){if(z.which===27){z.preventDefault();if(y.isOpen){z.stopPropagation()}y.close()}else{if(z.which===40&&!y.isOpen){y.isOpen=true}}};y.$watch("isOpen",function(z){if(z){y.$broadcast("datepicker.focus");y.position=v?g.offset(s):g.position(s);y.position.top=y.position.top+s.prop("offsetHeight");h.bind("mousedown",u)}else{h.unbind("mousedown",u)}});y.isTodayDisabled=function(){return x(new Date())};y.select=function(A){if(A==="today"||A=="now"){var z=new Date();if(angular.isDate(r.$modelValue)){A=new Date(r.$modelValue);A.setFullYear(z.getFullYear(),z.getMonth(),z.getDate());A.setHours(z.getHours(),z.getMinutes(),z.getSeconds(),z.getMilliseconds())}else{A=z}}y.dateSelection(A)};y.close=function(){y.isOpen=false;s[0].focus()};y.changePicker=function(z){y.showPicker=z};var i=d(m)(y);m.remove();if(v){h.find("body").append(i)}else{s.after(i)}y.$on("$destroy",function(){i.remove();s.unbind("keydown",q);h.unbind("mousedown",u)})}}}]).directive("datePickerWrap",function(){return{restrict:"EA",replace:true,transclude:true,templateUrl:"template/datetime-picker.html",link:function(c,b,a){b.bind("mousedown",function(d){d.preventDefault();d.stopPropagation()})}}}).directive("timePickerWrap",function(){return{restrict:"EA",replace:true,transclude:true,templateUrl:"template/datetime-picker.html",link:function(c,b,a){b.bind("mousedown",function(d){d.preventDefault();d.stopPropagation()})}}});angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function(a){a.put("template/datetime-picker.html",'<ul class="dropdown-menu dropdown-menu-left" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" style=left:inherit ng-keydown=keydown($event)><li style="padding:0 5px 5px 5px" class=datetime-picker><div ng-transclude></div></li><li ng-if=showButtonBar style=padding:5px><span class="btn-group pull-left" style=margin-right:10px><button ng-if="showPicker == \'date\'" type=button class="btn btn-sm btn-info" ng-click="select(\'today\')" ng-disabled=isTodayDisabled()>{{ getText(\'today\') }}</button> <button ng-if="showPicker == \'time\'" type=button class="btn btn-sm btn-info" ng-click="select(\'now\')" ng-disabled=isTodayDisabled()>{{ getText(\'now\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-click=select(null)>{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right"><button ng-if="showPicker == \'date\' && enableTime" type=button class="btn btn-sm btn-default" ng-click="changePicker(\'time\')">{{ getText(\'time\')}}</button> <button ng-if="showPicker == \'time\' && enableDate" type=button class="btn btn-sm btn-default" ng-click="changePicker(\'date\')">{{ getText(\'date\')}}</button> <button type=button class="btn btn-sm btn-success" ng-click=close()>{{ getText(\'close\') }}</button></span></li></ul>')}]);